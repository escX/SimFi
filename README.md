# SimFi
本项目由多个智能合约，以及可视化合约操作的前端项目组成，可以用来模拟一些简单的经济金融活动。

智能合约项目使用 Hardhat + ethers 开发，前端项目使用 React + Next + And Design 开发。

## 启动
1. 克隆项目到本地

2. 进入项目目录
    ```
    cd ./SimFi
    ```
3. 安装依赖项
    ```
    npm install
    ```
4. 编译智能合约、拷贝编译后文件到前端项目、启动Hardhat网络
    ```
    npm run start
    ```
5. 进入前端项目
    ```
    cd ./frontend
    ```
6. 安装依赖项
    ```
    npm install
    ```
7. 启动前端项目
    ```
    npm run dev
    ```
8. 在浏览器中打开 [http://localhost:3000/](http://localhost:3000/)

## 智能合约
### SFT.sol
本项目将会使用的符合 **ERC20** 规范的代币合约。
### DebT.sol
本项目中使用的债务合约。要理解它，您需要知道以下几点：
1. 债务是一类资产，可以进行流通交易。为了方便理解和计算，可以将债务视为一种特殊的代币（本项目中使用 **DebtToken** 表示），它和普通代币（在本项目中指 **SFT**）存在一个浮动的兑换比率，这个比率本质上由市场状况和市场对债务人的偿还预期所决定。
2. 债务只能由债务人创建，每一份 DebtToken 在创建时，都会被赋予四个固定属性：债务人账户、分期期数、每期每份债务应偿还代币数量、每期每份债务的违约金。本项目中，为方便模拟，约定每期固定时长为一分钟。
3. 债务创建后，会根据四个固定属性，生成一个哈希值，哈希值相同的债务份额，具有相同的价值和兑换比率。这意味着债务人可以多次分批创造相同的 DebtToken。
4. 债务刚创建时是没有债权人的，只有通过交易所交易，才能确认债权人。**债权确认**后，系统开始计算还款时间并在到期时，由债务人账户向债权人账户转账 SFT。若有一期未正常结清，将顺延分期，同时在此后每期中，增加需偿付的违约金。
5. 已确权债务也可以通过交易所交易，称为**债权转移**。债权确认和转移时，都会根据债务哈希、债权确认时间、当前期数、违约次数以及债权人账户生成一个哈希值，哈希值相同的话，具有相同的还款信息和债权人，可以进行**债务合并**。
6. 未确认债权的债务份额，可以被债务人撤销；确认债权的份额，只能通过偿还债务进行结算。债务人不会变化，但可以通过交易，改变债权人。交易过程将在交易所合约 **Exchange** 中实现。
7. 债务交易只能在第三方交易所进行，因为只有在交易所，债务才会有量化的价值体现。
### Exchange.sol
交易所合约。卖家发布交易，进行债权的确认或者转移，交易发生时，将从买家账户转账SFT到卖家账户，同时买家账户会收到债权份额。

## 前端项目
前端项目可以通过可视化的方式，部署本项目中的智能合约，执行合约方法，并记录操作历史。

项目地址：[SimFi Frontend](https://github.com/escX/SimFi/tree/main/frontend)。
